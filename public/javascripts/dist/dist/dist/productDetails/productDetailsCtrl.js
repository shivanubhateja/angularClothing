angular.module("mainApp").controller("productDetailsCtrl",["$scope","$stateParams","productService","locale","cartRelatedServices","$rootScope","$timeout","$state",function(e,t,o,r,i,c,n,s){e.init=function(t){o.getDetailsForProduct(t).then(function(t){e.details=t.data.productDetails,$(document).ready(function(){$(".owl-carousel.productDetails").owlCarousel({items:1,nav:!0,dots:!1,navText:['<i class="fa fa-chevron-left" aria-hidden="true"></i>','<i class="fa fa-chevron-right" aria-hidden="true"></i>']}),e.owl=$(".owl-carousel"),$("html, body").animate({scrollTop:0},"slow")})},function(e){})},e.getSizes=function(t){o.fetchAvailableSizes(t).then(function(t){e.sizes={};for(var o=0;o<r.sizes.length;o++)e.sizes[r.sizes[o]+""]=t.sizes[r.sizes[o]+""]?t.sizes[r.sizes[o]+""]:0},function(e){})},e.selectSize=function(t){e.selectedSize=t},e.nextImage=function(){e.owl.trigger("next.owl.carousel")},e.prevImage=function(){e.owl.trigger("prev.owl.carousel")},e.addToCart=function(t,o){e.buyNowOrAddToCartClicked=!0,o?(productToAdd={productId:t.id,quantity:1,size:o,productDetails:t},e.showSizeError=!1,e.showSizeError=!1,e.buyNowOrAddToCartClicked=!1,i.changeQuantityOfProductInCart(productToAdd,"+"),c.cart.cartDetails=JSON.parse(localStorage.getItem("cartDetails")),c.cartDropDownVisible=!0,delete e.selectedSize):e.showSizeError=!0,c.numberOfProductsInCart=i.cartDetails.length,n(function(){a()},1e3)},e.buyItNow=function(t,o){e.buyNowOrAddToCartClicked=!0,o?(productToAdd={productId:t.id,quantity:1,size:o,productDetails:t},e.showSizeError=!1,e.showSizeError=!1,e.buyNowOrAddToCartClicked=!1,localStorage.setItem("finalCart",JSON.stringify([productToAdd])),s.go("checkout",{src:"buyNow"}),delete e.selectedSize):e.showSizeError=!0,n(function(){a()},1e3)},e.selectSizeForRequest=function(t){e.sizeForRequest=t},e.sendRequestForSize=function(t,r){e.sizeForRequest?(o.sendRequestForSize(t,r,e.sizeForRequest).then(function(t){e.requestForSizeReceived=!0}),e.showRequestForSizeDiv=!1,e.requestForSizeBtnClicked=!1,delete e.sizeForRequest):e.requestForSizeBtnClicked=!0,n(function(){a()},1e3),n(function(){u()},1e3)},e.proceedToCheckOut=function(e){s.go("checkout",{cart:e})};var a=function(){e.buyNowOrAddToCartClicked=!1,e.requestForSizeBtnClicked=!1},u=function(){e.requestForSizeReceived=!1};e.$on("$stateChangeStart",function(e,t,o,r,i,n){"products"!==t.name||o.src===localStorage.getItem("anchor")||c.goingToHeader||(o.src=localStorage.getItem("anchor"),e.preventDefault(),s.go(t.name,o))}),e.showSizeError=!1,c.goingToHeader=!1,e.init(t.productId)}]);